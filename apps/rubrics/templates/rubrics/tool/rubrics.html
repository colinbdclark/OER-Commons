{% extends "rubrics/tool/base.html" %}
{% load markup %}

{% block content %}
  <div class="rubrics" data-evaluate-url="{% url rubrics:evaluate_rubrics content_type_id=content_type.id,object_id=object.id %}">
    <section id="alignment" class="expanded">
      <h1{% if alignment_scored %} class="scored"{% endif %}><a href="#">Degree of Alignment to Standards</a></h1>
      <div class="body">
        <div class="description">
          {% if not alignment_tags %}
            <p>Please align resource before evaluating alignment</p>
          {% else %}
            <p>Applies to objects that have suggested alignments to the Common Core Standards. Used to rate the degree to which an OER aligns to the Common Core Standards. The degree of alignment of both content and performance expectations is determined.</p>
          {% endif %}
        </div>
        <div class="tags">

          {% for tag in alignment_tags %}
            <div class="tag-description{% if forloop.first %} selected{% endif %}" data-tag-id="{{ tag.id }}">
              <div class="rc10">
                <strong class="standard">{{ tag.standard }}</strong>
                <span class="counter">{{ forloop.counter }} of {{ alignment_tags|length }}</span>
                <p class="grade">{{ tag.grade }}, {{ tag.category }}</p>
                <p><span>Domain:</span> {{ tag.subcategory }}</p>
                <p><span>Description:</span> {{ tag.description }}</p>
              </div>
            </div>
          {% endfor %}

          {% for tag in alignment_tags %}
            <a href="#" class="tag rc5{% if forloop.first %} selected{% endif %}{% if tag.score_value %} scored{% endif %}" data-tag-id="{{ tag.id }}">
              <span class="code rc3">{{ tag.full_code }}</span>
              <span class="value">{% if tag.score_value %}{% if tag.score_value.value != None %}{{ tag.score_value.value }} {{ tag.score_value.get_value_display }}{% else %}N/A{% endif %} {% else %}No score{% endif %}</span>
            </a>
          {% endfor %}

          {% for tag in alignment_tags %}
            <div class="scores{% if forloop.first %} selected{% endif %}" data-tag-id="{{ tag.id }}">
              {% for score in alignment_score_values %}
                <div class="s{{ forloop.counter }}{% if tag.score_value == score %} selected{% endif %}" data-score-id="{{ score.id }}">
                  <a href="#" class="rc5"><strong>{% if score.value != None %}{{ score.value }}{% else %}N/A{% endif %}</strong> {{ score.get_value_display }}</a>
                  <div class="description rc5">{{ score.description|markdown|safe }}</div>
                </div>
              {% endfor %}
            </div>
          {% endfor %}

          {% for tag in alignment_tags %}
            <div class="footer{% if forloop.first %} selected{% endif %}" data-tag-id="{{ tag.id }}">
              <a href="#" class="dashed clear">Clear rating</a>
              {% if not forloop.last %}
                <a href="#" class="next-tag rc5">Next standard</a>
              {% endif %}
              <a href="#" class="next rc5">Next</a>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>
    {% for rubric in rubrics %}
      <section class="rubric">
        <h1{% if rubric.score_value %} class="scored"{% endif %}><a href="#">{{ rubric.name }}</a></h1>
        <div class="body">
          <div class="description">
            {{ rubric.description|markdown|safe }}
          </div>
          <div class="scores" data-rubric-id="{{ rubric.id }}">
            {% for score in rubric.score_values.all %}
              <div class="s{{ forloop.counter }}{% if rubric.score_value == score %} selected{% endif %}" data-score-id="{{ score.id }}">
                <a href="#" class="rc5"><strong>{% if score.value != None %}{{ score.value }}{% else %}N/A{% endif %}</strong> {{ score.get_value_display }}</a>
                <div class="description rc5">{{ score.description|markdown|safe }}</div>
              </div>
            {% endfor %}
          </div>
          <div class="footer">
            <a href="#" class="dashed clear">Clear rating</a>
            {% if forloop.last %}
              <a href="{% url rubrics:evaluate_results content_type_id=content_type.id,object_id=object.id %}" class="save rc5">Save</a>
            {% else %}
              <a href="#" class="next rc5">Next</a>
            {% endif %}
          </div>
        </div>
      </section>
    {% endfor %}
  </div>
{% endblock %}

{% block extra-js %}
  <script>
    $(function() {
      oer.evaluation_tool.init_rubrics();
    });
  </script>
{% endblock %}
